(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{15845:function(e,n,r){e.exports=r(47434)().Promise},98922:function(e){"use strict";var n="@@any-promise/REGISTRATION",r=null;e.exports=function(e,t){return function(a,o){a=a||null;var i=!1!==(o=o||{}).global;if(null===r&&i&&(r=e[n]||null),null!==r&&null!==a&&r.implementation!==a)throw new Error('any-promise already defined as "'+r.implementation+'".  You can only register an implementation before the first  call to require("any-promise") and an implementation cannot be changed');return null===r&&(r=null!==a&&"undefined"!==typeof o.Promise?{Promise:o.Promise,implementation:a}:t(a),i&&(e[n]=r)),r}}},47434:function(e,n,r){"use strict";e.exports=r(98922)(window,(function(){if("undefined"===typeof window.Promise)throw new Error("any-promise browser requires a polyfill or explicit registration e.g: require('any-promise/register/bluebird')");return{Promise:window.Promise,implementation:"window.Promise"}}))},94184:function(e,n){var r;!function(){"use strict";var t={}.hasOwnProperty;function a(){for(var e=[],n=0;n<arguments.length;n++){var r=arguments[n];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)&&r.length){var i=a.apply(null,r);i&&e.push(i)}else if("object"===o)for(var l in r)t.call(r,l)&&r[l]&&e.push(l)}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(r=function(){return a}.apply(n,[]))||(e.exports=r)}()},13192:function(e){"use strict";e.exports=function(e){var n,r={};if(!(e instanceof Object)||Array.isArray(e))throw new Error("keyMirror(...): Argument must be an object.");for(n in e)e.hasOwnProperty(n)&&(r[n]=n);return r}},14559:function(e,n,r){"use strict";var t=r(9008);n.Z=t.default},74579:function(e,n,r){"use strict";r.d(n,{yU:function(){return g},NO:function(){return p},kd:function(){return f},tr:function(){return y}});r(57327),r(54747),r(49337);var t=r(4942),a=r(44925),o=(r(67294),r(94184)),i=r.n(o),l=r(13192),s=r.n(l),u=r(85893);const c=["hint","hintPosition","padding","size","theme"];function d(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function m(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?d(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}const g=s()({PRIMARY:null,CALL_TO_ACTION:null,CLOSE:null,DANGER:null,ICON:null,LINK:null,SECONDARY:null,SECONDARY_INVERT:null,HIDE_ADS:null}),p=s()({SMALL:null,FULL:null}),f=s()({TOP:null}),y=s()({NO_PAD:null}),h=e=>{e.hint;let n=e.hintPosition,r=e.padding,t=e.size,o=e.theme,l=(0,a.Z)(e,c);const s=Boolean(l.href)?"a":"button";return(0,u.jsx)(s,m(m({className:i()({btn:o!==g.HIDE_ADS,"btn-sm":t===p.SMALL,"btn-block":t===p.FULL,"btn-cta":o===g.CALL_TO_ACTION,"btn-close":o===g.CLOSE,"btn-icon":o===g.ICON,"btn-link":o===g.LINK||o===g.DANGER,"btn-primary":o===g.PRIMARY,"btn-secondary":o===g.SECONDARY,"btn-secondary-invert":o===g.SECONDARY_INVERT,"text-danger":o===g.DANGER,"hide-ads":o===g.HIDE_ADS,"pl-0":r===y.NO_PAD,"pr-0":r===y.NO_PAD,"hint--top":n===f.TOP})},l),{},{children:l.children}))};h.defaultProps={theme:g.PRIMARY},n.ZP=h},26173:function(e,n,r){"use strict";r.d(n,{y:function(){return u},Z:function(){return c}});var t=r(3086),a=r(94184),o=r.n(a),i=r(13192),l=r.n(i),s=r(85893);const u=l()({FULL_WIDTH:null});function c(e){const n=e.errMessage?{}:{display:"none"},r=e.successMessage?{}:{display:"none"};return(0,s.jsxs)("form",{id:e.id,className:o()({"full-width":e.theme===u.FULL_WIDTH}),onSubmit:e.onSubmit,children:[e.descriptionText?(0,s.jsx)("p",{children:"props.descriptionText"}):null,e.children,(0,s.jsx)("span",{className:"text-success",style:r,children:e.successMessage}),(0,s.jsxs)("span",{id:"error",style:n,children:["Error: ",e.errMessage]}),e.buttonLabel?(0,s.jsx)(t.Z,{disabled:e.disabled,label:e.buttonLabel,theme:e.buttonTheme,padding:e.buttonPadding,onSubmit:e.onSubmit}):null]})}},96767:function(e,n,r){"use strict";r.d(n,{k:function(){return u},Z:function(){return c}});r(57327),r(54747),r(49337);var t=r(44925),a=r(4942),o=(r(21249),r(85893));const i=["label","options","onChange"];function l(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?l(Object(r),!0).forEach((function(n){(0,a.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}const u=e=>(0,o.jsx)("div",{className:"form-field",children:e.children});function c(e){return(0,o.jsxs)(u,{children:[(0,o.jsx)("label",{htmlFor:e.name,children:e.label}),"select"===e.type?(0,o.jsx)(d,s({},e)):(0,o.jsx)("input",s(s({},e),{},{onChange:n=>e.onChange(n.target.value)}))]})}function d(e){e.label;const n=e.options,r=e.onChange,a=(0,t.Z)(e,i);return(0,o.jsx)("select",s(s({},a),{},{onChange:e=>r(e.target.value),children:n.map((e=>(0,o.jsx)("option",{value:e,children:e},e)))}))}},7986:function(e,n,r){"use strict";r.d(n,{Z:function(){return y}});const t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"LoginForm_me",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Me",abstractKey:null,hash:"497a19debdfc2c44cec95b28e3898893"};var a=t;const o=function(){var e={alias:null,args:null,kind:"ScalarField",name:"me",storageKey:null},n=[{alias:null,args:null,kind:"ScalarField",name:"userId",storageKey:null},e];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"LoginForm_codeshare",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"CreatedBy",kind:"LinkedField",name:"createdBy",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"ModifiedBy",kind:"LinkedField",name:"modifiedBy",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"CanEdit",kind:"LinkedField",name:"canEdit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"userIds",storageKey:null},e],storageKey:null}],type:"Codeshare",abstractKey:null}}();o.hash="9892f3cab56a99a6bb12365a64a08d14";var i=o;const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],n=[{kind:"Variable",name:"input",variableName:"input"}],r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"anonymous",storageKey:null},i={alias:null,args:[{kind:"Literal",name:"first",value:1}],concreteType:"CodeshareConnection",kind:"LinkedField",name:"codesharesCreated",plural:!1,selections:[{alias:null,args:null,concreteType:"CodeshareConnectionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Codeshare",kind:"LinkedField",name:"node",plural:!1,selections:[r],storageKey:null}],storageKey:null}],storageKey:"codesharesCreated(first:1)"},l={alias:null,args:null,kind:"ScalarField",name:"token",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"LoginFormMutation",selections:[{alias:null,args:n,concreteType:"AuthResponse",kind:"LinkedField",name:"login",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"Me",kind:"LinkedField",name:"me",plural:!1,selections:[r,t,a,o,i],storageKey:null},{args:null,kind:"FragmentSpread",name:"CodesharePage_viewer"}],storageKey:null},l],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"LoginFormMutation",selections:[{alias:null,args:n,concreteType:"AuthResponse",kind:"LinkedField",name:"login",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"Me",kind:"LinkedField",name:"me",plural:!1,selections:[r,t,a,o,i,{alias:null,args:null,concreteType:"UserSettings",kind:"LinkedField",name:"settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"theme",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"keymap",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"first",value:100}],concreteType:"SubscriptionPlanConnection",kind:"LinkedField",name:"subscriptionPlans",plural:!1,selections:[{alias:null,args:null,concreteType:"SubscriptionPlanConnectionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"SubscriptionPlan",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isActive",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"planId",storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:"subscriptionPlans(first:100)"}],storageKey:null}],storageKey:null},l],storageKey:null}]},params:{cacheID:"0ca08c9c30d966e4d89b24d6b5ffc2d1",id:null,metadata:{},name:"LoginFormMutation",operationKind:"mutation",text:"mutation LoginFormMutation(\n  $input: LoginInput!\n) {\n  login(input: $input) {\n    viewer {\n      me {\n        id\n        name\n        email\n        anonymous\n        codesharesCreated(first: 1) {\n          edges {\n            node {\n              id\n            }\n          }\n        }\n      }\n      ...CodesharePage_viewer\n    }\n    token\n  }\n}\n\nfragment AuthUserNavbar_me on Me {\n  anonymous\n  name\n  email\n  ...Gravatar_me\n}\n\nfragment CodeshareCodeMirror_me on Me {\n  id\n  ...useTheme_me\n  ...useKeymap_me\n}\n\nfragment CodeshareEditor_me on Me {\n  ...CodeshareFirepad_me\n}\n\nfragment CodeshareFirepad_me on Me {\n  id\n  ...CodeshareCodeMirror_me\n}\n\nfragment CodeshareHead_me on Me {\n  ...CodeshareLazyHead_me\n  ...useKeymap_me\n}\n\nfragment CodeshareKeymapFormField_me on Me {\n  ...useKeymap_me\n}\n\nfragment CodeshareLazyHead_me on Me {\n  ...useTheme_me\n}\n\nfragment CodeshareNavbar_me on Me {\n  anonymous\n  ...UserNavbar_me\n  ...CodeshareShareModal_me\n  ...PlansButton_me\n  ...isCodeshareProSubscriber_me\n}\n\nfragment CodesharePage_viewer on Viewer {\n  me {\n    ...CodeshareHead_me\n    ...CodeshareNavbar_me\n    ...CodeshareEditor_me\n    ...CodeshareSidebar_me\n    ...NagModal_me\n    ...isCodeshareProSubscriber_me\n    ...SponsorToast_me\n    ...SponsorFooter_me\n    id\n  }\n}\n\nfragment CodesharePlans_me on Me {\n  anonymous\n  ...CodeshareProCheckoutModal_me\n  ...isCodeshareProSubscriber_me\n  ...LoginRegisterModal_me\n}\n\nfragment CodeshareProCheckoutModal_me on Me {\n  ...CodeshareProForm_me\n}\n\nfragment CodeshareProForm_me on Me {\n  id\n  email\n}\n\nfragment CodeshareProModal_me on Me {\n  ...CodesharePlans_me\n}\n\nfragment CodeshareSettingsForm_me on Me {\n  anonymous\n  ...CodeshareThemeFormField_me\n  ...CodeshareKeymapFormField_me\n}\n\nfragment CodeshareShareModal_me on Me {\n  ...CodeshareViewOnlyCheckbox_me\n}\n\nfragment CodeshareSidebar_me on Me {\n  ...isCodeshareProSubscriber_me\n  ...CodeshareSettingsForm_me\n}\n\nfragment CodeshareThemeFormField_me on Me {\n  ...useTheme_me\n}\n\nfragment CodeshareViewOnlyCheckbox_me on Me {\n  anonymous\n  ...isCodeshareProSubscriber_me\n  ...CodeshareProModal_me\n}\n\nfragment Gravatar_me on Me {\n  name\n  email\n}\n\nfragment LoginForm_me on Me {\n  id\n}\n\nfragment LoginRegisterModal_me on Me {\n  ...LoginForm_me\n  ...RegisterForm_me\n}\n\nfragment NagModal_me on Me {\n  anonymous\n  ...LoginRegisterModal_me\n}\n\nfragment PlansButton_me on Me {\n  ...CodeshareProModal_me\n}\n\nfragment RegisterForm_me on Me {\n  id\n}\n\nfragment SponsorFooter_me on Me {\n  ...PlansButton_me\n  ...SponsorScriptToast_me\n}\n\nfragment SponsorScriptToast_me on Me {\n  ...PlansButton_me\n}\n\nfragment SponsorToast_me on Me {\n  ...PlansButton_me\n  ...SponsorScriptToast_me\n}\n\nfragment UserNavbar_me on Me {\n  anonymous\n  ...AuthUserNavbar_me\n}\n\nfragment isCodeshareProSubscriber_me on Me {\n  subscriptionPlans(first: 100) {\n    edges {\n      node {\n        isActive\n        planId\n        id\n      }\n    }\n  }\n}\n\nfragment useKeymap_me on Me {\n  id\n  anonymous\n  settings {\n    keymap\n  }\n}\n\nfragment useTheme_me on Me {\n  id\n  anonymous\n  settings {\n    theme\n  }\n}\n"}}}();l.hash="5692c818fbca711b0d239a2ead97ff2e";var s=l,u=r(26173),c=r(67294),d=r(51287),m=r(96767),g=r(67912),p=r(85893);const f=s;var y=e=>{const n=(0,c.useState)(""),r=n[0],t=n[1],o=(0,c.useState)(""),l=o[0],s=o[1];let y=null;e.codeshare&&(y=(0,g.useFragment)(i,e.codeshare));const h=(0,g.useFragment)(a,e.me);return(0,p.jsxs)(d.Z,{buttonLabel:e.buttonLabel||"Log in",theme:u.y.FULL_WIDTH,getMutationConfig:()=>({mutation:f,variables:{input:{email:r,password:l}},updater:e=>{const n=e.getRootField("login").getLinkedRecord("viewer"),r=n.getLinkedRecord("me");if(e.getRoot().setLinkedRecord(n,"viewer"),y){const n=e.get(y.id),t=null===n||void 0===n?void 0:n.getLinkedRecord("createdBy");null===t||void 0===t||t.setValue(t.getValue("userId")===r.getValue("id"),"me");const a=null===n||void 0===n?void 0:n.getLinkedRecord("modifiedBy");null===a||void 0===a||a.setValue(a.getValue("userId")===r.getValue("id"),"me");const o=null===n||void 0===n?void 0:n.getLinkedRecord("canEdit"),i=null===o||void 0===o?void 0:o.getValue("userIds");null===o||void 0===o||o.setValue(0===(null===i||void 0===i?void 0:i.length)||(null===i||void 0===i?void 0:i.contains(h.id)),"me")}return e},onSuccess:n=>{if(e.onSuccess)return e.onSuccess(n)}}),children:[(0,p.jsx)(m.Z,{name:"email",id:"email",type:"email",label:"Email address",autoFocus:!0,autoComplete:"email",required:!0,value:r,onChange:n=>{e.onEmailChange&&e.onEmailChange(n),t(n)}}),(0,p.jsx)(m.Z,{name:"password",id:"password",type:"password",label:"Password",autoComplete:"current-password",required:!0,value:l,onChange:s}),e.children]})}},51287:function(e,n,r){"use strict";r.d(n,{Z:function(){return f}});r(57327),r(54747),r(49337);var t=r(98152),a=r(4942),o=r(44925),i=r(26173),l=r(44311),s=r(67294),u=r(70230),c=r(67912),d=r(85893);const m=["getMutationConfig"];function g(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function p(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?g(Object(r),!0).forEach((function(n){(0,a.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function f(e){const n=e.getMutationConfig,r=(0,o.Z)(e,m),a=(0,c.useRelayEnvironment)(),g=(0,s.useState)(),f=g[0],y=g[1],h=(0,s.useState)(!1),b=h[0],v=h[1],k=(0,s.useRef)(!1);function C(e){k.current||e()}return(0,s.useEffect)((()=>()=>{k.current=!0}),[]),(0,d.jsx)(i.Z,p(p({},r),{},{disabled:b,errMessage:f,onSubmit:e=>{e.preventDefault(),C((()=>v(!0)));const r=n();if(null==r)return C((()=>y(void 0))),void C((()=>v(!1)));(0,l.commitMutation)(a,p(p({},r),{},{onError:e=>{console.error("mutation error",e),C((()=>{const n=(0,u.Z)(e);y((null===n||void 0===n?void 0:n.message)||"an unexpected error occurred, try again")})),C((()=>v(!1)))},onCompleted:(e,n)=>{const a=n||[],o=(0,t.Z)(a,1)[0];if(o)return C((()=>y(o.message))),void C((()=>v(!1)));if(!r.onSuccess)return C((()=>y(void 0))),void C((()=>v(!1)));const i=r.onSuccess(e);if(null==i)return C((()=>y(void 0))),void C((()=>v(!1)));i.then((()=>{C((()=>y(void 0))),C((()=>v(!1)))})).catch((e=>{C((()=>v(!1)))}))}}))},children:e.children}))}},3086:function(e,n,r){"use strict";r.d(n,{Z:function(){return c}});r(57327),r(54747),r(49337);var t=r(4942),a=r(44925),o=r(74579),i=r(85893);const l=["label"];function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function u(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function c(e){e.label;const n=(0,a.Z)(e,l);return(0,i.jsx)(o.ZP,u(u({type:"submit",theme:o.yU.PRIMARY},n),{},{children:e.disabled?"...":e.label}))}},22389:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return M}});var t=r(15861),a=r(87757),o=r.n(a);const i=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"anonymous",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"loginQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"Me",kind:"LinkedField",name:"me",plural:!1,selections:[e,n,r,t],storageKey:null},{args:null,kind:"FragmentSpread",name:"LoginPage_viewer"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"loginQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"Me",kind:"LinkedField",name:"me",plural:!1,selections:[e,n,r,t,{alias:null,args:[{kind:"Literal",name:"first",value:1}],concreteType:"CodeshareConnection",kind:"LinkedField",name:"codesharesCreated",plural:!1,selections:[{alias:null,args:null,concreteType:"CodeshareConnectionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Codeshare",kind:"LinkedField",name:"node",plural:!1,selections:[e],storageKey:null}],storageKey:null}],storageKey:"codesharesCreated(first:1)"}],storageKey:null}],storageKey:null}]},params:{cacheID:"d323978f47c2304b3e156f15b1c4533e",id:null,metadata:{},name:"loginQuery",operationKind:"query",text:"query loginQuery {\n  viewer {\n    me {\n      id\n      anonymous\n      email\n      name\n    }\n    ...LoginPage_viewer\n  }\n}\n\nfragment LoginForm_me on Me {\n  id\n}\n\nfragment LoginPage_viewer on Viewer {\n  me {\n    anonymous\n    codesharesCreated(first: 1) {\n      edges {\n        node {\n          id\n        }\n      }\n    }\n    ...LoginForm_me\n    id\n  }\n}\n"}}}();i.hash="d432edb3ceebbb5a82a8aeb859fbaed9";var l=i,s=r(67912),u=r(38631),c=r(50559);r(4723),r(88674);const d={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"LoginPage_viewer",selections:[{alias:null,args:null,concreteType:"Me",kind:"LinkedField",name:"me",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"anonymous",storageKey:null},{alias:null,args:[{kind:"Literal",name:"first",value:1}],concreteType:"CodeshareConnection",kind:"LinkedField",name:"codesharesCreated",plural:!1,selections:[{alias:null,args:null,concreteType:"CodeshareConnectionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Codeshare",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"codesharesCreated(first:1)"},{args:null,kind:"FragmentSpread",name:"LoginForm_me"}],storageKey:null}],type:"Viewer",abstractKey:null,hash:"de2e3a2099694a76425ba3bc58dc8844"};var m=d;const g={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"LoginPage_codeshare",selections:[{args:null,kind:"FragmentSpread",name:"LoginForm_codeshare"}],type:"Codeshare",abstractKey:null,hash:"712c0542636af62256cce94ac8bdbd60"};var p=g,f=r(22578),y=r(67294),h=r(14559),b=r(46359),v=r(7986),k=r(39765),C=r(30924),w=r(42195),_=r.n(w),F=r(6492),P=r(11163),S=r(85893);var O=function(e){var n,r,t;(0,y.useEffect)((()=>C.Z.page()),[]);const a=(0,y.useState)(),o=a[0],i=a[1],l=(0,s.useRelayEnvironment)(),u=e.codeshare&&(0,s.useFragment)(p,e.codeshare),c=(0,s.useFragment)(m,e.viewer),d=(0,y.useState)(c)[0],g=(0,P.useRouter)(),w=g.query.saveCodeshare,O=d.me,L=(null===(n=O.codesharesCreated)||void 0===n?void 0:n.edges)&&(null===(r=O.codesharesCreated)||void 0===r?void 0:r.edges[0]),j=null===(t=g.asPath)||void 0===t?void 0:t.match(/^[^?]+(\?.*)$/),x=j&&j[1]||"";return(0,S.jsxs)("div",{id:"login",children:[(0,S.jsx)(h.Z,{children:(0,S.jsx)("title",{children:"Log in - Codeshare"})}),(0,S.jsx)(k.Z,{}),(0,S.jsx)("main",{children:O.anonymous?(0,S.jsxs)("div",{className:"container",children:[(0,S.jsx)("h1",{className:"is-title",children:"Log in to access your saved code"}),(0,S.jsxs)("div",{className:"login-form-container",children:[(0,S.jsx)(v.Z,{me:O,codeshare:u,onEmailChange:e=>i(e),onSuccess:e=>{var n,r;C.Z.track("Log in",{});const t=e.login.viewer.me;return C.Z.identify(t.id,{anonymous:t.anonymous,name:t.name,email:t.email}),w?(0,f.commitMutation)(l,{mutation:F.Z,variables:{input:{id:_().encodeRelayId("Codeshare",Array.isArray(w)?w[0]:w),save:!0}},onError(){window.location.href="/".concat(w)},onCompleted(){window.location.href="/".concat(w)}}):null!==(n=e.login.viewer.me.codesharesCreated)&&void 0!==n&&null!==(r=n.edges)&&void 0!==r&&r.length?g.push("/codes"):g.push("/new"),new Promise((()=>{}))}}),(0,S.jsxs)("p",{className:"aligncenter",children:["New to Codeshare?"," ",(0,S.jsx)(b.Z,{href:"/register".concat(x),children:"Sign up here"}),"."]}),(0,S.jsx)("p",{className:"aligncenter",children:(0,S.jsx)(b.Z,{href:"/forgot-password?email=".concat(encodeURIComponent(o||"")),children:"Forgot your password?"})})]})]}):(0,S.jsxs)("div",{className:"container",children:[(0,S.jsx)("h1",{className:"is-title",children:"You're already logged in"}),(0,S.jsx)("div",{className:"login-form-container",children:(0,S.jsxs)("p",{children:[(0,S.jsx)(b.Z,{href:"/logout",rel:"nofollow",children:"Logout"})," to register a new account or ",L?(0,S.jsx)(b.Z,{href:"/codes",children:"visit your codeshares"}):(0,S.jsx)(b.Z,{href:"/new",rel:"nofollow",children:"create a codeshare"}),"."]})})]})})]})},L=r(73496),j=r(34555);const x=e=>{let n=e.apiHeaders,r=e.queryProps,t=e.queryRecords;c.Z.assert(r,"relay fetch failed",{apiHeaders:n,queryProps:r,queryRecords:t});const a=(0,L.Z)({apiHeaders:n,records:t}),o=r.viewer;return j.Z&&o.me.email&&C.Z.identify(o.me.id,{anonymous:o.me.anonymous,name:o.me.name,email:o.me.email}),(0,S.jsx)(s.RelayEnvironmentProvider,{environment:a,children:(0,S.jsx)(O,{viewer:o})})};x.getInitialProps=function(){var e=(0,t.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.Z)(n,l,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();var M=x},6492:function(e,n,r){"use strict";r.d(n,{Z:function(){return a}});const t=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UpdateCodeshareResponse",kind:"LinkedField",name:"updateCodeshare",plural:!1,selections:[{alias:null,args:null,concreteType:"Codeshare",kind:"LinkedField",name:"codeshare",plural:!1,selections:[n,{alias:null,args:null,concreteType:"CreatedBy",kind:"LinkedField",name:"createdBy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"me",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"userId",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"updateCodeshareMutation",selections:r,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"updateCodeshareMutation",selections:r},params:{cacheID:"c854318d8a2799fdee942073ca99ebb6",id:null,metadata:{},name:"updateCodeshareMutation",operationKind:"mutation",text:"mutation updateCodeshareMutation(\n  $input: UpdateCodeshareInput!\n) {\n  updateCodeshare(input: $input) {\n    codeshare {\n      id\n      createdBy {\n        me\n        user {\n          id\n        }\n        userId\n      }\n    }\n  }\n}\n"}}}();t.hash="77c0642d03487268ba091c23bff547cc";var a=t},38631:function(e,n,r){"use strict";var t=r(15861),a=(r(39714),r(83753),r(87757)),o=r.n(a),i=r(55568),l=r(50559),s=r(73496),u=r(67912),c=r(84511),d=r(92432),m=r(3746);function g(e,n,r,t){return p.apply(this,arguments)}function p(){return(p=(0,t.Z)(o().mark((function e(n,r,t,a){var p,h,b,v,k,C,w,_,F,P;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.H)({req:n.req,res:n.res,logger:d.Z,forceNewSession:a});case 2:return p=e.sent,h=p.apiHeaders,b=p.environment,e.prev=5,e.next=8,(0,i.Z)((()=>{try{return(0,u.fetchQuery)(b,r,t).toPromise()}catch(w){const n=(0,c.Z)(w);if(f(n)||y(n))throw i.V.wrap(w,"non-retryable");throw w}}),o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d.Z.debug("fetchQuery retry 1"),e.next=3,0;case 3:return d.Z.debug("fetchQuery retry 2"),e.next=6,100;case 6:return d.Z.debug("fetchQuery retry 3"),e.next=9,200;case 9:case"end":return e.stop()}}),e)})));case 8:v=e.sent,e.next=22;break;case 11:if(e.prev=11,e.t0=e.catch(5),k=(0,c.Z)(e.t0),C=null===k||void 0===k?void 0:k.status,!f(k)||a){e.next=18;break}return d.Z.debug("authentication error, retrying with new session",{status:C,apiError:k}),e.abrupt("return",g(n,r,t,!0));case 18:throw w=new l.Z("fetchQuery error",{query:r.toString(),vars:t}).wrap(e.t0),(_=(0,c.Z)(e.t0))&&(f(_)||y(_))?"current"in _&&_.current%(null!==(F=_.limit)&&void 0!==F?F:100)!==0||d.Z.warn("fetch query error warning",{message:null===_||void 0===_?void 0:_.message}):/FetchError:/.test(null===e.t0||void 0===e.t0?void 0:e.t0.message)?d.Z.error("fetch query network error",{originalErr:e.t0}):d.Z.error("fetch query error",{err:w,originalErr:e.t0,apiError:_}),w;case 22:return P=b.getStore().getSource().toJSON(),e.abrupt("return",{apiHeaders:h,queryProps:v,queryRecords:P,userAgent:(0,m.Z)(n)});case 24:case"end":return e.stop()}}),e,null,[[5,11]])})))).apply(this,arguments)}function f(e){var n;return 401===(null===e||void 0===e?void 0:e.status)||"UNAUTHENTICATED"===(null===e||void 0===e||null===(n=e.extensions)||void 0===n?void 0:n.code)}function y(e){var n,r;return 429===(null===e||void 0===e?void 0:e.status)||/rate limit/.test(null!==(n=null!==(r=null===e||void 0===e?void 0:e.stack)&&void 0!==r?r:null===e||void 0===e?void 0:e.message)&&void 0!==n?n:"")}n.Z=g},3746:function(e,n,r){"use strict";function t(e){let n=e.req;return n?n.headers["user-agent"]||"Unknown":navigator.userAgent}r.d(n,{Z:function(){return t}})},55568:function(e,n,r){"use strict";r.d(n,{V:function(){return u},Z:function(){return c}});var t=r(15861),a=r(87757),o=r.n(a),i=r(50559),l=r(19920),s=r.n(l);class u extends i.Z{}function c(e,n){return d.apply(this,arguments)}function d(){return(d=(0,t.Z)(o().mark((function e(n,r){var t,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n();case 3:return e.abrupt("return",e.sent);case 6:if(e.prev=6,e.t0=e.catch(0),!(e.t0 instanceof u)){e.next=10;break}throw e.t0.source;case 10:if(t=r(),!(a=t.next()).done){e.next=14;break}throw e.t0;case 14:return e.next=16,s()(a.value);case 16:return e.next=18,c(n,(()=>t));case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}},87237:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return r(22389)}])},11163:function(e,n,r){e.exports=r(34651)},19920:function(e,n,r){var t=r(15845);e.exports=function(e){var n,r=new t((function(r){n=setTimeout(r,e||0)}));return r.clear=function(){return clearTimeout(n)},r}},98152:function(e,n,r){"use strict";function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function a(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,a,o=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(t=r.next()).done)&&(o.push(t.value),!n||o.length!==n);i=!0);}catch(s){l=!0,a=s}finally{try{i||null==r.return||r.return()}finally{if(l)throw a}}return o}}(e,n)||function(e,n){if(e){if("string"===typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.d(n,{Z:function(){return a}})}},function(e){e.O(0,[774,566,607,702,578,229,888,179],(function(){return n=87237,e(e.s=n);var n}));var n=e.O();_N_E=n}]);